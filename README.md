REST API demo project written in Python

# Docs

API documentation is available at http://127.0.0.1:8000/docs#/ when running the app locally.

# Development

## Tests

### Build docker image for Tests

docker build -t py_rest_demo_test -f Dockerfile.test .

### Run docker image for Tests

docker run --rm py_rest_demo_test

## Run app

### Build docker image for dev

docker build -t py_rest_demo -f Dockerfile.dev .

### Run docker image for dev

docker run --rm -p 8000:8000 -v $(pwd)/app:/app -e SECRET_KEY=gouda_kaas py_rest_demo

## Dev curl commands

### Create user

curl -i -X POST http://127.0.0.1:8000/register \
  -H "Content-Type: application/json" \
  -d '{

    "username": "larssaalbrink@gmail.com",
    "password": "kaaskop"

  }'

### Get token (and store it in TOKEN env var)

export TOKEN=$(curl -s -X POST "http://127.0.0.1:8000/login" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "username=larssaalbrink@gmail.com" \
  -d "password=kaaskop" | jq -r '.access_token')

### Create task (Requires token)

curl -i -X POST "http://127.0.0.1:8000/tasks" \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{

    "title": "Eat cheese",
    "description": "Eat all cheese currently in the fridge",
    "due_date": "2025-02-21"

  }'

### Get tasks (Requires token)

curl http://127.0.0.1:8000/tasks \
  -H "Authorization: Bearer $TOKEN"

### Update task (Requires token)

curl -i -X PUT "http://127.0.0.1:8000/tasks/52066650752017374089771338888820989312" \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{

    "title": "Drink milk",
    "description": "Drink absurd amount of milk",
    "due_date": "2025-03-01"

  }'

### Delete task (Requires token)

curl -i -X DELETE "http://127.0.0.1:8000/tasks/52066650752017374089771338888820989312" \
  -H "Authorization: Bearer $TOKEN"

# Production

Server currently hosted on Google Cloud Platform, accessible at https://larssaalbrink.dk

## CI/CD

### Certs

Current certs are valid until 2025-05-01.
This demo does not auto-refresh certs, as server will be decommissioned before this date.
New certs can manually be generated by running
sudo certbot --nginx -d larssaalbrink.dk -d www.larssaalbrink.dk
on the server.

### Start production docker image

docker run -p 80:80 -p 443:443 -e SECRET_KEY=<A_GREAT_SECRET> -d <DOCKER_IMAGE_ID>

## Production curl commands

### Create user

curl -i -X POST https://larssaalbrink.dk/register \
  -H "Content-Type: application/json" \
  -d '{

    "username": "larssaalbrink@gmail.com",
    "password": "kaaskop"

  }'

### Get token (and store it in TOKEN env var)

export TOKEN=$(curl -s -X POST "https://larssaalbrink.dk/login" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "username=larssaalbrink@gmail.com" \
  -d "password=kaaskop" | jq -r '.access_token')

### Create task (Requires token)

curl -i -X POST "https://larssaalbrink.dk/tasks" \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{

    "title": "Eat cheese",
    "description": "Eat all cheese currently in the fridge",
    "due_date": "2025-02-21"

  }'

### Get tasks (Requires token)

curl https://larssaalbrink.dk/tasks \
  -H "Authorization: Bearer $TOKEN"

### Update task (Requires token)

curl -i -X PUT "https://larssaalbrink.dk/tasks/52066650752017374089771338888820989312" \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{

    "title": "Drink milk",
    "description": "Drink absurd amount of milk",
    "due_date": "2025-03-01"

  }'

### Delete task (Requires token)

curl -i -X DELETE "https://larssaalbrink.dk/tasks/52066650752017374089771338888820989312" \
  -H "Authorization: Bearer $TOKEN"
